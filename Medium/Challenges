with cte_1 as (select h.hacker_id, h.name, count(c.challenge_id) as total from hackers as h join challenges as c on h.hacker_id=c.hacker_id group by h.hacker_id, h.name order by total desc, h.hacker_id asc), cte_2 as(select total,count(cte_1.hacker_id) as kisi from cte_1 group by cte_1.total) select cte_1.hacker_id, cte_1.name, cte_1.total from cte_1 join cte_2 on cte_1.total=cte_2.total where cte_2.kisi in(1,(select distinct(kisi) from cte_2 where total=(select max(cte_2.total) from cte_2))) order by cte_1.total desc, cte_1.hacker_id asc;
