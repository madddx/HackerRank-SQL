SELECT res.hacker_id, res.name, res.maxi from ( SELECT h.hacker_id, h.name, sum(S.max_score) as maxi FROM( SELECT DISTINCT s.hacker_id, challenge_id, MAX(score) over ( partition by hacker_id , challenge_id) as max_score FROM Submissions s ) AS S JOIN Hackers h ON h.hacker_id = S.hacker_id GROUP BY h.hacker_id, h.name )AS res WHERE res.maxi > 0 ORDER BY res.maxi DESC, res.hacker_id ;
